"use strict";!function(e){var r=e.module("appModule",["ngRoute"],["$httpProvider",function(r){r.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";var n=function o(e){var r,n,t,i,l,s,a,c="";for(r in e)if(n=e[r],n instanceof Array)for(a=0;a<n.length;++a)l=n[a],t=r+"["+a+"]",s={},s[t]=l,c+=o(s)+"&";else if(n instanceof Object)for(i in n)l=n[i],t=r+"["+i+"]",s={},s[t]=l,c+=o(s)+"&";else void 0!==n&&null!==n&&(c+=encodeURIComponent(r)+"="+encodeURIComponent(n)+"&");return c.length?c.substr(0,c.length-1):c};r.defaults.transformRequest=[function(r){return e.isObject(r)&&"[object File]"!==String(r)?n(r):r}]}]);r.factory("ipcService",["$http","$q",function(e,r){return{positions:function(n){n=isNaN(parseInt(n))?1:parseInt(n);var o=r.defer();return e.post("/api/admin/query",{field:["positionId","haveProduct"],from:"positions",pagination:40,page:n}).success(function(e){o.resolve(JSON.parse(e).list)}).error(function(e){o.reject(e)}),o.promise},positionPages:function(){var n=r.defer();return e.post("/api/admin/maxPages",{pagination:40}).success(function(e){n.resolve(JSON.parse(e))}).error(function(e){n.reject(e)}),n.promise},unnoticedOrders:function(n){var o=r.defer();return e.post("/api/admin/query",{where:[{key:"haveNoticed",value:0}],field:["orderId","usrPhoneNumber"],from:"orders",pagination:20,page:n}).success(function(e){o.resolve(JSON.parse(e).list)}).error(function(e){o.reject(e)}),o.promise},order:function(n){var o=r.defer();return e.post("/api/admin/query",{where:[{key:"orderId",value:n}],field:["orderId","usrPhoneNumber","orderInfo","usrId","positionId","importTime","exportTime"],from:"orders"}).success(function(e){var r=JSON.parse(e);1==r.status?o.resolve(r.list):2==r.status&&o.resolve({response:r.response,failed:!0})}).error(function(e){o.reject(e)}),o.promise},usr:function(n){var o=r.defer();return e.post("/api/admin",{where:[{key:"name",value:n}],field:["usrId","usrPhoneNumber","psw","lastIp","name","lastLogin"],from:"usr"}).success(function(e){o.resolve(JSON.parse(e))}).error(function(e){o.reject(e)}),o.promise}}}]),r.config(["$routeProvider",function(e){e.when("/",{controller:"IndexController",templateUrl:"/tpl/admin/index.html"}).when("/index",{controller:"IndexController",templateUrl:"/tpl/admin/index.html"}).when("/containerStatus",{controller:"containerStatusController",templateUrl:"/tpl/admin/containerStatus.html"}).when("/unnoticed",{controller:"unnoticedController",templateUrl:"/tpl/admin/unnoticed.html"}).when("/backOrder",{controller:"backOrderController",templateUrl:"/tpl/admin/backOrder.html"}).when("/usrStatus",{controller:"usrStatusController",templateUrl:"/tpl/admin/usrStatus.html"}).when("/usrOrder",{controller:"usrOrderController",templateUrl:"/tpl/admin/usrOrder.html"}).when("/orderConf",{controller:"orderConfController",templateUrl:"/tpl/admin/orderConf.html"})}]);r.controller("containerStatusController",["$scope","ipcService",function(e,r){e.nowPage="1",r.positions(e.nowPage).then(function(r){e.positions=r}),r.positionPages(e.nowPage).then(function(r){e.pages=r}),e.$watch("nowPage",function(n){r.positions(e.nowPage).then(function(r){e.positions=r})})}]),r.controller("unnoticedController",["$scope","ipcService",function(e,r){e.nowPage="1",r.unnoticedOrders(e.nowPage).then(function(r){e.unnoticedOrders=r}),e.$watch("nowPage",function(n){r.unnoticedOrders(e.nowPage).then(function(r){e.unnoticedOrders=r})})}]),r.controller("backOrderController",["$scope",function(e){}]),r.controller("usrStatusController",["$scope","ipcService",function(e,r){e.datahave=!1,r.usr(e.usrid).then(function(r){e.usr=r.list,e.datahave=parseInt(r.lenght)>0})}]),r.controller("usrOrderController",function(e,r,n){e.orderid="",r.order(e.nowPage).then(function(r){e.order=r}),e.$watch("orderid",function(n){var o=/\b\d{12}\b/g;null!==n.toString().match(o)&&r.order(e.orderid).then(function(r){e.order=r})})}),r.controller("orderConfController",["$scope",function(e){e.datahave=!1,ipcService.order(e.orderid).then(function(r){e.order=r})}]),r.controller("IndexController",["$scope",function(e){}])}(angular);