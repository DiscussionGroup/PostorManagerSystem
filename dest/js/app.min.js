"use strict";!function(t){var n=t.module("appModule",["ngRoute"],["$httpProvider",function(n){n.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";var e=function r(t){var n,e,o,i,a,l,d,c="";for(n in t)if(e=t[n],e instanceof Array)for(d=0;d<e.length;++d)a=e[d],o=n+"["+d+"]",l={},l[o]=a,c+=r(l)+"&";else if(e instanceof Object)for(i in e)a=e[i],o=n+"["+i+"]",l={},l[o]=a,c+=r(l)+"&";else void 0!==e&&null!==e&&(c+=encodeURIComponent(n)+"="+encodeURIComponent(e)+"&");return c.length?c.substr(0,c.length-1):c};n.defaults.transformRequest=[function(n){return t.isObject(n)&&"[object File]"!==String(n)?e(n):n}]}]);n.factory("ipcService",["$http","$q",function(t,n){return{positions:function(n){return n=isNaN(parseInt(n))?1:parseInt(n),t.post("/api/admin/query",{field:["positionId","haveProduct"],from:"positions",pagination:40,page:n})},positionPages:function(){return t.post("/api/admin/maxPages",{pagination:40})},unnoticedOrders:function(n){return t.post("/api/admin/query",{where:[{key:"haveNoticed",value:0}],field:["orderId","usrPhoneNumber"],from:"orders",pagination:20,page:n})},order:function(n){return t.post("/api/admin/query",{where:[{key:"orderId",value:n}],field:["orderId","usrPhoneNumber","orderInfo","usrId","positionId","importTime","exportTime"],from:"orders"})},usr:function(n){return t.post("/api/admin/query",{where:[{key:"name",value:n}],field:["id","phoneNumber","psw","lastIp","name","email","lastLogin"],from:"usr"})},editUsr:function(n){return t.post("/api/admin/editUsr",{usr:n})},adminName:function(){return t.post("/api/admin/getRootName",{})}}}]),n.config(["$routeProvider",function(t){t.when("/",{controller:"IndexController",templateUrl:"/tpl/admin/index.html"}).when("/index",{controller:"IndexController",templateUrl:"/tpl/admin/index.html"}).when("/containerStatus",{controller:"containerStatusController",templateUrl:"/tpl/admin/containerStatus.html"}).when("/unnoticed",{controller:"unnoticedController",templateUrl:"/tpl/admin/unnoticed.html"}).when("/backOrder",{controller:"backOrderController",templateUrl:"/tpl/admin/backOrder.html"}).when("/usrStatus",{controller:"usrStatusController",templateUrl:"/tpl/admin/usrStatus.html"}).when("/usrOrder",{controller:"usrOrderController",templateUrl:"/tpl/admin/usrOrder.html"}).when("/orderConf",{controller:"orderConfController",templateUrl:"/tpl/admin/orderConf.html"})}]);n.controller("containerStatusController",["$scope","ipcService",function(t,n){t.nowPage="1";var e=function(){n.positions(t.nowPage).then(function(n){t.positions=JSON.parse(n.data).list}),n.positionPages(t.nowPage).then(function(t){})};t.$watch("nowPage",e)}]),n.controller("msgController",["$scope","ipcService",function(t,n){t.username="root",n.adminName().then(function(n){t.username=n.data.name})}]),n.controller("unnoticedController",["$scope","ipcService",function(t,n){t.datahave=!1,t.nowPage="1";var e=function(){n.unnoticedOrders(t.nowPage).then(function(n){t.unnoticedOrders=JSON.parse(n.data).list,t.datahave=parseInt(t.unnoticedOrders.length)>0})};t.$watch("nowPage",e)}]),n.controller("backOrderController",["$scope",function(t){}]),n.controller("usrStatusController",["$scope","ipcService",function(t,n){t.datahave=!1;var e=function(){n.usr(t.usrid).then(function(n){t.usr=n.data.list[0],t.datahave=parseInt(n.data.list.length)>0})};t.$watch("usrid",function(t){var n=/\b\w{6,12}\b/g;t&&null!==t.toString().match(n)&&e()}),t.confirm=function(){console.log("this"),n.editUsr(t.usr).then(function(n){alert("success"),t.datahave=!1},function(){alert("false,you may need a second try")})}}]),n.controller("usrOrderController",["$scope","ipcService","$http",function(t,n,e){t.orderid="",t.datahave=!1;var r=function(){n.order(t.orderid).then(function(n){t.order=n.data.list})};t.$watch("orderid",function(t){var n=/\b\d{12}\b/g;null!==t.toString().match(n)&&r()})}]),n.controller("orderConfController",["$scope","ipcService","$http",function(t,n,e){t.datahave=!1;var r=function(){n.order(t.orderid).then(function(n){n.data.list?t.datahave=parseInt(n.data.list.length)>0:t.datahave=!1,t.order=n.data.list[0]})};r(),t.$watch("orderid",r)}]),n.controller("IndexController",["$scope",function(t){}]);n.directive("edit",["$document",function(t){return{restrict:"AE",scope:{edata:"="},template:'<div ng-show="isEditing"><div class="input-control"><input class="input" ng-model="edata"></div><button ng-click="confirm()" class="button primary">确认</button></div><div ng-click="edit()" ng-hide="isEditing">编辑</div>',link:function(t,n,e,r){t.edit=function(){t.isEditing=!0},t.confirm=function(){t.isEditing=!1}}}}])}(angular);